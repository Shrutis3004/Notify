'use strict';

var axios = require('axios');
var App = require('./app');
var Device = require('./device');

/**
 * OneSignal SDK
 *
 * @param {Object} opts.api_key API Key for Onesignal account.
 * @returns {Object}
 */
module.exports = function OneSignalSDK(opts) {
  if (!opts.api_key) {
    throw new Error('API Key is required.');
  }

  var baseAxios = axios.create({
    baseURL: 'https://onesignal.com/api/v1',
    headers: {
      Authorization: 'Basic ' + opts.api_key
    },
    timeout: process.env.NODE_ENV === 'testing' ? 3000 : undefined
  });

  var apps = App(baseAxios);
  var devices = Device(baseAxios);

  return Object.assign({}, apps, devices);
};